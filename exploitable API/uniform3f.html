<html>
<head><title>webgl test</title></head>
<body>
<canvas id='myCanvas' width='256' height='256'></canvas>
<div id="res"></div>

<script>
function getRandom(num){
	var list = [];
	for(var i=0;i<num;i++){
		e = (Math.random()*255).toFixed(6);
		list.push(e);
	}
	var div = document.getElementById('res');
	div.innerHTML = list;
}
//getRandom(5000);

String.prototype.hashCode = function() {
  var hash = 0, i, chr;
  if (this.length === 0) return hash;
  for (i = 0; i < this.length; i++) {
	chr   = this.charCodeAt(i);
	hash  = ((hash << 5) - hash) + chr;
	hash |= 0; // Convert to 32bit integer
  }
  return hash;
};
</script>
	
<script>

var canvas = document.getElementById("myCanvas");
var gl = canvas.getContext('webgl',{ antialias: false, depth: false });

if (!gl) {
	console.log('can not use webgl');
}


var debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
console.log( gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) );
console.log( gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) );

	
function createShader(gl, type, source) {
		  var shader = gl.createShader(type);
		  gl.shaderSource(shader, source);
		  gl.compileShader(shader);
		  var success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);
		  if (success) {
			return shader;
		  }
			if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
				console.error('ERROR compiling vertex shader!',
				gl.getShaderInfoLog(shader));
			}
		}

function createProgram(gl, vertexShader, fragmentShader) {
  var program = gl.createProgram();
  gl.attachShader(program, vertexShader);
  gl.attachShader(program, fragmentShader);
  gl.linkProgram(program);
  var success = gl.getProgramParameter(program, gl.LINK_STATUS);
  if (success) {
	return program;
  }

  console.log(gl.getProgramInfoLog(program));  // eslint-disable-line
  gl.deleteProgram(program);
  return undefined;
}



var vertexShaderSource = `
void main() {
	gl_Position = vec4(0, 0, 0, 1.0);
	gl_PointSize = 20.0;
}
`
	
	
var fragmentShaderSource = `
precision highp float;
uniform vec3 v_f;

void main() {	
	gl_FragColor = vec4(v_f.x, v_f.y , v_f.z, 1.0);
}
`                            
	

	
// create GLSL shaders, upload the GLSL source, compile the shaders
var vertexShader = createShader(gl, gl.VERTEX_SHADER, vertexShaderSource);
var fragmentShader = createShader(gl, gl.FRAGMENT_SHADER, fragmentShaderSource);

// Link the two shaders into a program
var program = createProgram(gl, vertexShader, fragmentShader);

gl.useProgram(program);



	
var size = 1;
var pixelArray = [];
var v_f = gl.getUniformLocation(program, 'v_f');

var x = [0.830886,0.783679,0.716609,0.921997,0.348124,0.771244,0.578800,0.943141,0.724243,0.456636,0.149929,0.634523,0.101486,0.828067,0.534065,0.630624,0.947867,0.535613,0.754702,0.109631,0.940171,0.483401,0.581909,0.568260,0.627067,0.966148,0.039746,0.457784,0.346527,0.731128,0.292560,0.748392,0.969210,0.709258,0.726788,0.312862,0.252222,0.483927,0.668620,0.607186,0.449987,0.473910,0.088040,0.864248,0.194800,0.342613,0.630128,0.291767,0.968622,0.411890,0.041886,0.093159,0.684439,0.026269,0.065226,0.540192,0.804224,0.193822,0.022232,0.595879,0.017635,0.022707,0.211180,0.795172,0.690699,0.764070,0.801280,0.174263,0.484756,0.127535,0.710263,0.826283,0.895738,0.932298,0.080514,0.118961,0.913098,0.416297,0.267416,0.141380,0.159917,0.882754,0.782598,0.414968,0.935908,0.111034,0.167562,0.516206,0.679222,0.123462,0.010653,0.779353,0.858510,0.887588,0.581439,0.293210,0.990336,0.164256,0.312140,0.085664];

gl.clearColor(0.0, 0.0, 0.0, 1.0);
gl.clear(gl.COLOR_BUFFER_BIT);

for(var i=0; i<50; i=i+3){
	gl.uniform3f(v_f, x[i], x[i+1], x[i+2]);
	
	gl.drawArrays(gl.POINTS, 0, 1);

	var pixel = new Uint8Array(size*size*4);	
	gl.readPixels(128, 127, size, size, gl.RGBA, gl.UNSIGNED_BYTE, pixel);
	pixelArray.push(i+':'+pixel);
//	console.log(pixel);
}

var div = document.getElementById('res');
div.innerHTML = 'Your fingerprint: ' + (pixelArray.join("_")).hashCode();

</script>
	
</body>
</html>